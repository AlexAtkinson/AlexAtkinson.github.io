<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Alex Atkinson — pages.evilkittens.co</title>
    <meta name="description" content="Curated index of useful GISTs." />
    <link rel="canonical" href="https://pages.evilkittens.co/" />
    <link rel="stylesheet" href="assets/theme.css">
    <script src="assets/theme.js" defer></script>
</head>
<body>
    <div class="hero">
        <div class="hero-inner">
                <div class="container">
                    <h2>Github Pages</h2>
                    <p class="small">A lightweight index of tools and knowledge that I share publicly.</p>
                </div>
        </div>
    </div>

    <div class="wrap">
        <header>
        <div class="header-left">
            <div class="avatar-wrap">
                <img class="avatar" src="assets/images/avatar-alex-in-summer.jpg" alt="Alex Atkinson avatar">
            </div>
            <div>
                <h1>Alex Atkinson</h1>
                <div class="sub">Dev*Ops, Infrastructure, and Platform Engineer</div>
            </div>
        </div>
        <div class="header-right">
            <button class="theme-toggle" data-theme-toggle aria-pressed="false" title="Toggle theme"></button>
        </div>
        </header>

        <main>
            <section class="card" id="intro">
                <h2>Introduction</h2>
                <p class="small">
                    This is a lightweight landing page and an index of curated GISTs I maintain. Use it to browse snippets, tools, and knowledge that I share publicly.
                </p>
            </section>

            <section class="card" id="gists">
                <h2>Curated GISTs</h2>
                <p class="small">Primers represent foundational material on a subject, which may contain guides, while Guides and references are just that.</p>

                <div id="gist-list" class="grid" aria-live="polite">
                    <!-- Placeholder content while JS populates -->
                    <div class="list-empty card">Loading gists…</div>
                </div>

                <noscript class="small">
                    JavaScript is disabled. To populate this index, enable JavaScript or edit this page with static links to your gists.
                </noscript>
            </section>
        </main>

        <footer>
            <div>Stay Cool</div>
        </footer>
    </div>

    <script>
        // Curated list: replace these IDs with real GIST IDs to display titles and description automatically.
        // The site will prefer a pre-generated `assets/gists.json` (created by
        // `scripts/fetch_gists.py`) if present to avoid live API calls.
        const curated = [
            /* Example: 'a1b2c3d4e5f6g7h8i9j0' */
            '42d91031604aaedc0ec5a879afb3410f',
            '7be00d6be71fab970210006b9574e1e5',
            '37d64e4e0527f6e5f9d57280669ad055',
            '31b5bc527b07406950618a7e6bd1ec81',
            '7246dfafa76973c6cc60ac5fa5ce0858',
            'f0bf8c89dda97ef42b5ba3575ab20363'
        ];

        const container = document.getElementById('gist-list');

        async function fetchGist(id){
            const res = await fetch('https://api.github.com/gists/' + id);
            if(!res.ok) throw new Error('Failed to fetch gist ' + id);
            return res.json();
        }

        function titleFromFilename(fn){
            if(!fn) return '';
            let name = fn.replace(/^[^a-zA-Z0-9]+/, '');
            name = name.replace(/\.[^/.]+$/, '');
            return name || fn;
        }

        (async function render(){
            container.innerHTML = ''; // clear placeholder

            // 1) Try to load a local pre-built asset to avoid API calls
            try{
                const res = await fetch('assets/gists.json', {cache: 'no-cache'});
                if(res.ok){
                    const local = await res.json();
                    if(Array.isArray(local) && local.length){
                        for(const gist of local){
                            const wrapper = document.createElement('div');
                            wrapper.className = 'gist card';
                            const firstFile = Object.keys(gist.files || {})[0];
                            const title = titleFromFilename(firstFile) || gist.description || gist.id;
                            const html = [
                                `<a href="${escapeHtml(gist.html_url)}" target="_blank" rel="noopener noreferrer">${escapeHtml(title)}</a>`,
                                `<div class="meta">${escapeHtml(gist.description || '')}</div>`
                            ].join('');
                            wrapper.innerHTML = html;
                            container.appendChild(wrapper);
                        }
                        return; // done
                    }
                }
            }catch(e){
                // fall through to live-fetch fallback
                console.warn('Local gists.json not found or invalid, falling back to API');
            }

            // 2) Fallback: live fetch using curated IDs
            if(!curated.length){
                container.innerHTML = '<div class="list-empty card">No gists configured.</div>';
                return;
            }

            for(const id of curated){
                const wrapper = document.createElement('div');
                wrapper.className = 'gist card';
                wrapper.innerHTML = '<div class="small">Loading…</div>';
                container.appendChild(wrapper);

                try{
                    if(id.startsWith('PLACEHOLDER')){
                        wrapper.innerHTML = '<strong>Replace PLACEHOLDER_GIST_ID with a real Gist ID</strong><div class="meta">Edit index in index.html to point to curated gists.</div>';
                        continue;
                    }
                    const gist = await fetchGist(id);
                    const firstFile = Object.keys(gist.files)[0];
                    const title = titleFromFilename(firstFile) || gist.description || id;
                    const html = [
                        `<a href="${gist.html_url}" target="_blank" rel="noopener noreferrer">${escapeHtml(title)}</a>`,
                        `<div class="meta">${escapeHtml(gist.description || '')}</div>`
                    ].join('');
                    wrapper.innerHTML = html;
                }catch(err){
                    wrapper.innerHTML = '<strong>Unable to load gist: ' + escapeHtml(id) + '</strong><div class="meta">' + escapeHtml(err.message) + '</div>';
                }
            }
        })();

        function escapeHtml(str){ return String(str).replace(/[&<>"']/g, s => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[s])); }
    </script>
</body>
</html>